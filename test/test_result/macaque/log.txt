2023-11-30 13:59:05,449 - root - INFO - 创建日志文件...
2023-11-30 13:59:05,456 - root - INFO - 创建 Model 对象完成...
2023-11-30 13:59:05,471 - root - INFO - 正在执行 preprocess() 函数...
2023-11-30 13:59:05,474 - root - INFO - 模式=unsupervised
2023-11-30 13:59:05,478 - root - INFO - 聚类方法=louvain
2023-11-30 13:59:05,481 - root - INFO - 分辨率=3.0
2023-11-30 13:59:05,484 - root - INFO - 批次键=BATCH
2023-11-30 13:59:05,491 - root - INFO - Normalize counts per cell(sum=10000.0)
2023-11-30 13:59:05,801 - root - INFO - Log1p data
2023-11-30 13:59:06,115 - root - INFO - Select HVG(n_top_genes=1000)
2023-11-30 13:59:07,126 - root - INFO - Scale batch(scale_value=10.0)
2023-11-30 13:59:07,758 - root - INFO - Calculate PCA(n_comps=100)
2023-11-30 13:59:23,116 - root - INFO - Apply louvain clustring(resolution=3.0) initization
2023-11-30 13:59:23,121 - root - INFO - Number of Cluster =36
2023-11-30 13:59:23,127 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]
2023-11-30 13:59:23,132 - root - INFO - 预处理数据集完成。
2023-11-30 13:59:23,137 - root - INFO - mode=unsupervised
2023-11-30 13:59:23,262 - root - INFO - K_in=6, K_bw=12
2023-11-30 13:59:23,265 - root - INFO - 开始计算 KNN 和 MNN 以获取簇之间的相似性。
2023-11-30 13:59:23,267 - root - INFO - 使用近似方法计算每个批次内的 KNN 对...
2023-11-30 13:59:23,289 - root - INFO - Calculate KNN pair intra batch...........
2023-11-30 13:59:23,291 - root - INFO - K=6
2023-11-30 13:59:23,293 - root - INFO - metric=cosine
2023-11-30 13:59:23,296 - root - INFO - Processing datasets: (0, 0) = ('M1', 'M1')
2023-11-30 13:59:25,039 - root - INFO - There are (88762) KNN pairs when processing (0, 0)=('M1', 'M1')
2023-11-30 13:59:25,042 - root - INFO - Processing datasets: (1, 1) = ('M2', 'M2')
2023-11-30 13:59:26,679 - root - INFO - There are (83752) KNN pairs when processing (1, 1)=('M2', 'M2')
2023-11-30 13:59:26,682 - root - INFO - Processing datasets: (2, 2) = ('M3', 'M3')
2023-11-30 13:59:27,280 - root - INFO - There are (37118) KNN pairs when processing (2, 2)=('M3', 'M3')
2023-11-30 13:59:27,282 - root - INFO - Processing datasets: (3, 3) = ('M4', 'M4')
2023-11-30 13:59:27,887 - root - INFO - There are (37770) KNN pairs when processing (3, 3)=('M4', 'M4')
2023-11-30 13:59:27,890 - root - INFO - scDML finds (247402) KNN pairs in dataset finally
2023-11-30 13:59:28,270 - root - INFO - 使用近似方法计算批次之间的 MNN 对...
2023-11-30 13:59:28,290 - root - INFO - Calculate MNN pair inter batch...........
2023-11-30 13:59:28,293 - root - INFO - K=12
2023-11-30 13:59:28,297 - root - INFO - metric=cosine
2023-11-30 13:59:28,300 - root - INFO - Processing datasets: (0, 1) = ('M1', 'M2')
2023-11-30 13:59:29,957 - root - INFO - There are (78896) MNN pairs when processing (0, 1)=('M1', 'M2')
2023-11-30 13:59:29,960 - root - INFO - Processing datasets: (0, 2) = ('M1', 'M3')
2023-11-30 13:59:31,136 - root - INFO - There are (56510) MNN pairs when processing (0, 2)=('M1', 'M3')
2023-11-30 13:59:31,138 - root - INFO - Processing datasets: (0, 3) = ('M1', 'M4')
2023-11-30 13:59:32,302 - root - INFO - There are (46166) MNN pairs when processing (0, 3)=('M1', 'M4')
2023-11-30 13:59:32,304 - root - INFO - Processing datasets: (1, 2) = ('M2', 'M3')
2023-11-30 13:59:33,441 - root - INFO - There are (55608) MNN pairs when processing (1, 2)=('M2', 'M3')
2023-11-30 13:59:33,443 - root - INFO - Processing datasets: (1, 3) = ('M2', 'M4')
2023-11-30 13:59:34,604 - root - INFO - There are (54082) MNN pairs when processing (1, 3)=('M2', 'M4')
2023-11-30 13:59:34,606 - root - INFO - Processing datasets: (2, 3) = ('M3', 'M4')
2023-11-30 13:59:35,264 - root - INFO - There are (35764) MNN pairs when processing (2, 3)=('M3', 'M4')
2023-11-30 13:59:35,266 - root - INFO - scDML finds (327026) MNN pairs in dataset finally
2023-11-30 13:59:35,970 - root - INFO - 查找所有最近邻居完成。
2023-11-30 13:59:35,972 - root - INFO - 计算簇之间的相似性矩阵。
2023-11-30 13:59:36,183 - root - INFO - delete inner edge which link same cluster
2023-11-30 13:59:36,186 - root - INFO - 27136 knn pair in batch link different cluster
2023-11-30 13:59:36,411 - root - INFO - delete inner edge which link same cluster
2023-11-30 13:59:36,414 - root - INFO - 149700 mnn pair in batch link different cluster
2023-11-30 13:59:36,417 - root - INFO - ===================================================================================
2023-11-30 13:59:36,420 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=5.516656839622642
2023-11-30 13:59:36,423 - root - INFO - ===================================================================================
2023-11-30 13:59:36,431 - root - INFO - 将相似性矩阵保存到文件中...
2023-11-30 13:59:36,442 - root - INFO - 将 nn 配对矩阵保存到文件中。
2023-11-30 13:59:36,447 - root - INFO - 完成相似性矩阵计算。
2023-11-30 13:59:36,541 - root - INFO - scDML merge cluster with rule2....
2023-11-30 13:59:36,548 - root - INFO - merge_rule2....
2023-11-30 13:59:36,937 - root - INFO - merging cluster set:[{2}, {17}, {18}, {30}, {3, 4, 11, 16, 23, 24, 28}, {32, 1, 34, 35, 14, 15}, {10, 27, 13, 7}, {19, 5, 22}, {0, 33, 21, 25}, {8, 9, 20, 31}, {29, 6}, {26, 12}]
2023-11-30 13:59:36,941 - root - INFO - 为scDML培训构建嵌入网络
2023-11-30 13:59:36,950 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-11-30 13:59:36,954 - root - INFO - 构建嵌入网络完成…
2023-11-30 13:59:36,959 - root - INFO - train scDML(expect_num_cluster=12) with Embedding Net
2023-11-30 13:59:36,962 - root - INFO - expect_num_cluster=12
2023-11-30 13:59:36,965 - root - INFO - 利用CPU训练模型
2023-11-30 13:59:36,970 - root - INFO - use euclidean distance and hard triplet to train model
2023-11-30 13:59:36,973 - root - INFO - not use earlystopping!!!!
2023-11-30 13:59:40,007 - root - INFO - epoch=1,number_hard_triplet=168733,loss=3265.2109375
2023-11-30 13:59:42,927 - root - INFO - epoch=2,number_hard_triplet=68702,loss=6067.0185546875
2023-11-30 13:59:45,979 - root - INFO - epoch=3,number_hard_triplet=49488,loss=6625.716796875
2023-11-30 13:59:49,381 - root - INFO - epoch=4,number_hard_triplet=34646,loss=7551.47265625
2023-11-30 13:59:52,955 - root - INFO - epoch=5,number_hard_triplet=25334,loss=7960.6533203125
2023-11-30 13:59:56,397 - root - INFO - epoch=6,number_hard_triplet=18840,loss=8228.900390625
2023-11-30 14:00:00,147 - root - INFO - epoch=7,number_hard_triplet=15241,loss=8318.857421875
2023-11-30 14:00:03,730 - root - INFO - epoch=8,number_hard_triplet=12203,loss=8946.712890625
2023-11-30 14:00:07,428 - root - INFO - epoch=9,number_hard_triplet=8718,loss=8731.1474609375
2023-11-30 14:00:11,245 - root - INFO - epoch=10,number_hard_triplet=7528,loss=8946.6806640625
2023-11-30 14:00:15,196 - root - INFO - epoch=11,number_hard_triplet=6001,loss=8806.7431640625
2023-11-30 14:00:18,997 - root - INFO - epoch=12,number_hard_triplet=4471,loss=7964.38037109375
2023-11-30 14:00:22,708 - root - INFO - epoch=13,number_hard_triplet=3175,loss=7812.228515625
2023-11-30 14:00:26,350 - root - INFO - epoch=14,number_hard_triplet=3103,loss=7862.49755859375
2023-11-30 14:00:30,087 - root - INFO - epoch=15,number_hard_triplet=2495,loss=7092.224609375
2023-11-30 14:00:33,618 - root - INFO - epoch=16,number_hard_triplet=2103,loss=6991.888671875
2023-11-30 14:00:37,106 - root - INFO - epoch=17,number_hard_triplet=2081,loss=7200.296875
2023-11-30 14:00:40,564 - root - INFO - epoch=18,number_hard_triplet=1674,loss=7539.58203125
2023-11-30 14:00:44,085 - root - INFO - epoch=19,number_hard_triplet=1623,loss=7056.72509765625
2023-11-30 14:00:47,439 - root - INFO - epoch=20,number_hard_triplet=1336,loss=6669.34765625
2023-11-30 14:00:50,737 - root - INFO - epoch=21,number_hard_triplet=1308,loss=6840.115234375
2023-11-30 14:00:54,064 - root - INFO - epoch=22,number_hard_triplet=1173,loss=6712.677734375
2023-11-30 14:00:57,273 - root - INFO - epoch=23,number_hard_triplet=1171,loss=7088.69873046875
2023-11-30 14:01:00,579 - root - INFO - epoch=24,number_hard_triplet=971,loss=6337.60302734375
2023-11-30 14:01:03,769 - root - INFO - epoch=25,number_hard_triplet=1015,loss=6593.388671875
2023-11-30 14:01:06,916 - root - INFO - epoch=26,number_hard_triplet=905,loss=6682.14013671875
2023-11-30 14:01:09,994 - root - INFO - epoch=27,number_hard_triplet=793,loss=6702.71435546875
2023-11-30 14:01:13,084 - root - INFO - epoch=28,number_hard_triplet=749,loss=6689.36767578125
2023-11-30 14:01:16,268 - root - INFO - epoch=29,number_hard_triplet=785,loss=6591.0283203125
2023-11-30 14:01:19,387 - root - INFO - epoch=30,number_hard_triplet=749,loss=6332.79296875
2023-11-30 14:01:22,435 - root - INFO - epoch=31,number_hard_triplet=739,loss=6526.9169921875
2023-11-30 14:01:25,406 - root - INFO - epoch=32,number_hard_triplet=751,loss=7850.2265625
2023-11-30 14:01:28,278 - root - INFO - epoch=33,number_hard_triplet=719,loss=6625.54248046875
2023-11-30 14:01:31,278 - root - INFO - epoch=34,number_hard_triplet=550,loss=6677.9287109375
2023-11-30 14:01:34,286 - root - INFO - epoch=35,number_hard_triplet=571,loss=6515.28759765625
2023-11-30 14:01:37,163 - root - INFO - epoch=36,number_hard_triplet=487,loss=6632.60791015625
2023-11-30 14:01:40,040 - root - INFO - epoch=37,number_hard_triplet=447,loss=5329.44189453125
2023-11-30 14:01:42,847 - root - INFO - epoch=38,number_hard_triplet=407,loss=5996.67578125
2023-11-30 14:01:45,697 - root - INFO - epoch=39,number_hard_triplet=523,loss=7448.4755859375
2023-11-30 14:01:48,645 - root - INFO - epoch=40,number_hard_triplet=469,loss=6292.06591796875
2023-11-30 14:01:51,447 - root - INFO - epoch=41,number_hard_triplet=470,loss=7245.95703125
2023-11-30 14:01:54,219 - root - INFO - epoch=42,number_hard_triplet=388,loss=6542.177734375
2023-11-30 14:01:57,041 - root - INFO - epoch=43,number_hard_triplet=442,loss=6836.08349609375
2023-11-30 14:01:59,782 - root - INFO - epoch=44,number_hard_triplet=468,loss=6340.45654296875
2023-11-30 14:02:02,532 - root - INFO - epoch=45,number_hard_triplet=428,loss=5854.91943359375
2023-11-30 14:02:05,527 - root - INFO - epoch=46,number_hard_triplet=344,loss=4856.65966796875
2023-11-30 14:02:08,237 - root - INFO - epoch=47,number_hard_triplet=403,loss=6396.4140625
2023-11-30 14:02:10,955 - root - INFO - epoch=48,number_hard_triplet=534,loss=8753.40625
2023-11-30 14:02:13,700 - root - INFO - epoch=49,number_hard_triplet=325,loss=6555.021484375
2023-11-30 14:02:16,328 - root - INFO - epoch=50,number_hard_triplet=322,loss=5152.31201171875
2023-11-30 14:02:19,057 - root - INFO - epoch=51,number_hard_triplet=254,loss=5174.22802734375
2023-11-30 14:02:21,927 - root - INFO - epoch=52,number_hard_triplet=245,loss=4922.2470703125
2023-11-30 14:02:24,606 - root - INFO - epoch=53,number_hard_triplet=274,loss=5846.05029296875
2023-11-30 14:02:27,274 - root - INFO - epoch=54,number_hard_triplet=474,loss=7883.24267578125
2023-11-30 14:02:29,980 - root - INFO - epoch=55,number_hard_triplet=302,loss=4632.88330078125
2023-11-30 14:02:32,692 - root - INFO - epoch=56,number_hard_triplet=310,loss=5759.43994140625
2023-11-30 14:02:35,419 - root - INFO - epoch=57,number_hard_triplet=301,loss=6856.2646484375
2023-11-30 14:02:38,201 - root - INFO - epoch=58,number_hard_triplet=413,loss=7370.4287109375
2023-11-30 14:02:40,837 - root - INFO - epoch=59,number_hard_triplet=346,loss=6789.3173828125
2023-11-30 14:02:43,484 - root - INFO - epoch=60,number_hard_triplet=289,loss=6576.34619140625
2023-11-30 14:02:46,063 - root - INFO - epoch=61,number_hard_triplet=283,loss=6615.50537109375
2023-11-30 14:02:48,683 - root - INFO - epoch=62,number_hard_triplet=312,loss=6506.9443359375
2023-11-30 14:02:51,412 - root - INFO - epoch=63,number_hard_triplet=217,loss=4975.95556640625
2023-11-30 14:02:54,175 - root - INFO - epoch=64,number_hard_triplet=247,loss=6454.95556640625
2023-11-30 14:02:56,896 - root - INFO - epoch=65,number_hard_triplet=318,loss=8075.97021484375
2023-11-30 14:02:59,519 - root - INFO - epoch=66,number_hard_triplet=194,loss=6306.3173828125
2023-11-30 14:03:02,140 - root - INFO - epoch=67,number_hard_triplet=266,loss=5495.8515625
2023-11-30 14:03:04,706 - root - INFO - epoch=68,number_hard_triplet=335,loss=5029.50830078125
2023-11-30 14:03:07,314 - root - INFO - epoch=69,number_hard_triplet=404,loss=6674.54833984375
2023-11-30 14:03:10,037 - root - INFO - epoch=70,number_hard_triplet=250,loss=7006.8583984375
2023-11-30 14:03:12,613 - root - INFO - epoch=71,number_hard_triplet=177,loss=5098.55908203125
2023-11-30 14:03:15,181 - root - INFO - epoch=72,number_hard_triplet=192,loss=5906.380859375
2023-11-30 14:03:17,763 - root - INFO - epoch=73,number_hard_triplet=222,loss=6669.85400390625
2023-11-30 14:03:20,281 - root - INFO - epoch=74,number_hard_triplet=154,loss=4796.44091796875
2023-11-30 14:03:22,900 - root - INFO - epoch=75,number_hard_triplet=214,loss=6901.93798828125
2023-11-30 14:03:25,658 - root - INFO - epoch=76,number_hard_triplet=150,loss=4784.81201171875
2023-11-30 14:03:28,236 - root - INFO - epoch=77,number_hard_triplet=197,loss=6312.7724609375
2023-11-30 14:03:30,773 - root - INFO - epoch=78,number_hard_triplet=189,loss=7040.25048828125
2023-11-30 14:03:33,372 - root - INFO - epoch=79,number_hard_triplet=171,loss=6375.41015625
2023-11-30 14:03:35,885 - root - INFO - epoch=80,number_hard_triplet=164,loss=7098.98876953125
2023-11-30 14:03:38,425 - root - INFO - epoch=81,number_hard_triplet=161,loss=6961.478515625
2023-11-30 14:03:41,111 - root - INFO - epoch=82,number_hard_triplet=136,loss=5829.56103515625
2023-11-30 14:03:43,663 - root - INFO - epoch=83,number_hard_triplet=549,loss=7215.38525390625
2023-11-30 14:03:46,193 - root - INFO - epoch=84,number_hard_triplet=192,loss=5844.1943359375
2023-11-30 14:03:48,720 - root - INFO - epoch=85,number_hard_triplet=203,loss=6760.494140625
2023-11-30 14:03:51,230 - root - INFO - epoch=86,number_hard_triplet=159,loss=6695.06494140625
2023-11-30 14:03:53,782 - root - INFO - epoch=87,number_hard_triplet=222,loss=7837.5107421875
2023-11-30 14:03:56,412 - root - INFO - epoch=88,number_hard_triplet=168,loss=5156.3623046875
2023-11-30 14:03:59,055 - root - INFO - epoch=89,number_hard_triplet=154,loss=5724.6796875
2023-11-30 14:04:01,590 - root - INFO - epoch=90,number_hard_triplet=120,loss=6239.14404296875
2023-11-30 14:04:04,124 - root - INFO - epoch=91,number_hard_triplet=117,loss=5141.29248046875
2023-11-30 14:04:06,625 - root - INFO - epoch=92,number_hard_triplet=140,loss=5992.3994140625
2023-11-30 14:04:09,134 - root - INFO - epoch=93,number_hard_triplet=280,loss=6859.0029296875
2023-11-30 14:04:11,750 - root - INFO - epoch=94,number_hard_triplet=116,loss=5050.9072265625
2023-11-30 14:04:14,360 - root - INFO - epoch=95,number_hard_triplet=167,loss=6641.4697265625
2023-11-30 14:04:16,856 - root - INFO - epoch=96,number_hard_triplet=169,loss=7565.109375
2023-11-30 14:04:19,396 - root - INFO - epoch=97,number_hard_triplet=128,loss=5996.27490234375
2023-11-30 14:04:21,937 - root - INFO - epoch=98,number_hard_triplet=197,loss=7542.52099609375
2023-11-30 14:04:24,474 - root - INFO - epoch=99,number_hard_triplet=185,loss=5982.806640625
2023-11-30 14:04:27,055 - root - INFO - epoch=100,number_hard_triplet=195,loss=7606.9267578125
2023-11-30 14:04:27,059 - root - INFO - scDML training done....
2023-11-30 14:04:27,063 - root - INFO - extract embedding for dataset with trained network
ard_triplet=25334,loss=7960.6533203125
2023-11-30 13:59:56,397 - root - INFO - epoch=6,number_hard_triplet=18840,loss=8228.900390625
2023-11-30 14:00:00,147 - root - INFO - epoch=7,number_hard_triplet=15241,loss=8318.857421875
2023-11-30 14:00:03,730 - root - INFO - epoch=8,number_hard_triplet=12203,loss=8946.712890625
2023-11-30 14:00:07,428 - root - INFO - epoch=9,number_hard_triplet=8718,loss=8731.1474609375
2023-11-30 14:00:11,245 - root - INFO - epoch=10,number_hard_triplet=7528,loss=8946.6806640625
2023-11-30 14:00:15,196 - root - INFO - epoch=11,number_hard_triplet=6001,loss=8806.7431640625
2023-11-30 14:00:18,997 - root - INFO - epoch=12,number_hard_triplet=4471,loss=7964.38037109375
2023-11-30 14:00:22,708 - root - INFO - epoch=13,number_hard_triplet=3175,loss=7812.228515625
2023-11-30 14:00:26,350 - root - INFO - epoch=14,number_hard_triplet=3103,loss=7862.49755859375
2023-11-30 14:00:30,087 - root - INFO - epoch=15,number_hard_triplet=2495,loss=7092.224609375
2023-11-30 14:00:33,618 - root - INFO - epoch=16,number_hard_triplet=2103,loss=6991.888671875
2023-11-30 14:00:37,106 - root - INFO - epoch=17,number_hard_triplet=2081,loss=7200.296875
2023-11-30 14:00:40,564 - root - INFO - epoch=18,number_hard_triplet=1674,loss=7539.58203125
2023-11-30 14:00:44,085 - root - INFO - epoch=19,number_hard_triplet=1623,loss=7056.72509765625
2023-11-30 14:00:47,439 - root - INFO - epoch=20,number_hard_triplet=1336,loss=6669.34765625
2023-11-30 14:00:50,737 - root - INFO - epoch=21,number_hard_triplet=1308,loss=6840.115234375
2023-11-30 14:00:54,064 - root - INFO - epoch=22,number_hard_triplet=1173,loss=6712.677734375
2023-11-30 14:00:57,273 - root - INFO - epoch=23,number_hard_triplet=1171,loss=7088.69873046875
2023-11-30 14:01:00,579 - root - INFO - epoch=24,number_hard_triplet=971,loss=6337.60302734375
2023-11-30 14:01:03,769 - root - INFO - epoch=25,number_hard_triplet=1015,loss=6593.388671875
2023-11-30 14:01:06,916 - root - INFO - epoch=26,number_hard_triplet=905,loss=6682.14013671875
2023-11-30 14:01:09,994 - root - INFO - epoch=27,number_hard_triplet=793,loss=6702.71435546875
2023-11-30 14:01:13,084 - root - INFO - epoch=28,number_hard_triplet=749,loss=6689.36767578125
2023-11-30 14:01:16,268 - root - INFO - epoch=29,number_hard_triplet=785,loss=6591.0283203125
2023-11-30 14:01:19,387 - root - INFO - epoch=30,number_hard_triplet=749,loss=6332.79296875
2023-11-30 14:01:22,435 - root - INFO - epoch=31,number_hard_triplet=739,loss=6526.9169921875
2023-11-30 14:01:25,406 - root - INFO - epoch=32,number_hard_triplet=751,loss=7850.2265625
2023-11-30 14:01:28,278 - root - INFO - epoch=33,number_hard_triplet=719,loss=6625.54248046875
2023-11-30 14:01:31,278 - root - INFO - epoch=34,number_hard_triplet=550,loss=6677.9287109375
2023-11-30 14:01:34,286 - root - INFO - epoch=35,number_hard_triplet=571,loss=6515.28759765625
2023-11-30 14:01:37,163 - root - INFO - epoch=36,number_hard_triplet=487,loss=6632.60791015625
2023-11-30 14:01:40,040 - root - INFO - epoch=37,number_hard_triplet=447,loss=5329.44189453125
2023-11-30 14:01:42,847 - root - INFO - epoch=38,number_hard_triplet=407,loss=5996.67578125
2023-11-30 14:01:45,697 - root - INFO - epoch=39,number_hard_triplet=523,loss=7448.4755859375
2023-11-30 14:01:48,645 - root - INFO - epoch=40,number_hard_triplet=469,loss=6292.06591796875
2023-11-30 14:01:51,447 - root - INFO - epoch=41,number_hard_triplet=470,loss=7245.95703125
2023-11-30 14:01:54,219 - root - INFO - epoch=42,number_hard_triplet=388,loss=6542.177734375
2023-11-30 14:01:57,041 - root - INFO - epoch=43,number_hard_triplet=442,loss=6836.08349609375
2023-11-30 14:01:59,782 - root - INFO - epoch=44,number_hard_triplet=468,loss=6340.45654296875
2023-11-30 14:02:02,532 - root - INFO - epoch=45,number_hard_triplet=428,loss=5854.91943359375
2023-11-30 14:02:05,527 - root - INFO - epoch=46,number_hard_triplet=344,loss=4856.65966796875
2023-11-30 14:02:08,237 - root - INFO - epoch=47,number_hard_triplet=403,loss=6396.4140625
2023-11-30 14:02:10,955 - root - INFO - epoch=48,number_hard_triplet=534,loss=8753.40625
2023-11-30 14:02:13,700 - root - INFO - epoch=49,number_hard_triplet=325,loss=6555.021484375
2023-11-30 14:02:16,328 - root - INFO - epoch=50,number_hard_triplet=322,loss=5152.31201171875
2023-11-30 14:02:19,057 - root - INFO - epoch=51,number_hard_triplet=254,loss=5174.22802734375
2023-11-30 14:02:21,927 - root - INFO - epoch=52,number_hard_triplet=245,loss=4922.2470703125
2023-11-30 14:02:24,606 - root - INFO - epoch=53,number_hard_triplet=274,loss=5846.05029296875
2023-11-30 14:02:27,274 - root - INFO - epoch=54,number_hard_triplet=474,loss=7883.24267578125
2023-11-30 14:02:29,980 - root - INFO - epoch=55,number_hard_triplet=302,loss=4632.88330078125
2023-11-30 14:02:32,692 - root - INFO - epoch=56,number_hard_triplet=310,loss=5759.43994140625
2023-11-30 14:02:35,419 - root - INFO - epoch=57,number_hard_triplet=301,loss=6856.2646484375
2023-11-30 14:02:38,201 - root - INFO - epoch=58,number_hard_triplet=413,loss=7370.4287109375
2023-11-30 14:02:40,837 - root - INFO - epoch=59,number_hard_triplet=346,loss=6789.3173828125
2023-11-30 14:02:43,484 - root - INFO - epoch=60,number_hard_triplet=289,loss=6576.34619140625
2023-11-30 14:02:46,063 - root - INFO - epoch=61,number_hard_triplet=283,loss=6615.50537109375
2023-11-30 14:02:48,683 - root - INFO - epoch=62,number_hard_triplet=312,loss=6506.9443359375
2023-11-30 14:02:51,412 - root - INFO - epoch=63,number_hard_triplet=217,loss=4975.95556640625
2023-11-30 14:02:54,175 - root - INFO - epoch=64,number_hard_triplet=247,loss=6454.95556640625
2023-11-30 14:02:56,896 - root - INFO - epoch=65,number_hard_triplet=318,loss=8075.97021484375
2023-11-30 14:02:59,519 - root - INFO - epoch=66,number_hard_triplet=194,loss=6306.3173828125
2023-11-30 14:03:02,140 - root - INFO - epoch=67,number_hard_triplet=266,loss=5495.8515625
2023-11-30 14:03:04,706 - root - INFO - epoch=68,number_hard_triplet=335,loss=5029.50830078125
2023-11-30 14:03:07,314 - root - INFO - epoch=69,number_hard_triplet=404,loss=6674.54833984375
2023-11-30 14:03:10,037 - root - INFO - epoch=70,number_hard_triplet=250,loss=7006.8583984375
2023-11-30 14:03:12,613 - root - INFO - epoch=71,number_hard_triplet=177,loss=5098.55908203125
2023-11-30 14:03:15,181 - root - INFO - epoch=72,number_hard_triplet=192,loss=5906.380859375
2023-11-30 14:03:17,763 - root - INFO - epoch=73,number_hard_triplet=222,loss=6669.85400390625
2023-11-30 14:03:20,281 - root - INFO - epoch=74,number_hard_triplet=154,loss=4796.44091796875
2023-11-30 14:03:22,900 - root - INFO - epoch=75,number_hard_triplet=214,loss=6901.93798828125
2023-11-30 14:03:25,658 - root - INFO - epoch=76,number_hard_triplet=150,loss=4784.81201171875
2023-11-30 14:03:28,236 - root - INFO - epoch=77,number_hard_triplet=197,loss=6312.7724609375
2023-11-30 14:03:30,773 - root - INFO - epoch=78,number_hard_triplet=189,loss=7040.25048828125
2023-11-30 14:03:33,372 - root - INFO - epoch=79,number_hard_triplet=171,loss=6375.41015625
2023-11-30 14:03:35,885 - root - INFO - epoch=80,number_hard_triplet=164,loss=7098.98876953125
2023-11-30 14:03:38,425 - root - INFO - epoch=81,number_hard_triplet=161,loss=6961.478515625
2023-11-30 14:03:41,111 - root - INFO - epoch=82,number_hard_triplet=136,loss=5829.56103515625
2023-11-30 14:03:43,663 - root - INFO - epoch=83,number_hard_triplet=549,loss=7215.38525390625
2023-11-30 14:03:46,193 - root - INFO - epoch=84,number_hard_triplet=192,loss=5844.1943359375
2023-11-30 14:03:48,720 - root - INFO - epoch=85,number_hard_triplet=203,loss=6760.494140625
2023-11-30 14:03:51,230 - root - INFO - epoch=86,number_hard_triplet=159,loss=6695.06494140625
2023-11-30 14:03:53,782 - root - INFO - epoch=87,number_hard_triplet=222,loss=7837.5107421875
2023-11-30 14:03:56,412 - root - INFO - epoch=88,number_hard_triplet=168,loss=5156.3623046875
2023-11-30 14:03:59,055 - root - INFO - epoch=89,number_hard_triplet=154,loss=5724.6796875
2023-11-30 14:04:01,590 - root - INFO - epoch=90,number_hard_triplet=120,loss=6239.14404296875
2023-11-30 14:04:04,124 - root - INFO - epoch=91,number_hard_triplet=117,loss=5141.29248046875
2023-11-30 14:04:06,625 - root - INFO - epoch=92,number_hard_triplet=140,loss=5992.3994140625
2023-11-30 14:04:09,134 - root - INFO - epoch=93,number_hard_triplet=280,loss=6859.0029296875
2023-11-30 14:04:11,750 - root - INFO - epoch=94,number_hard_triplet=116,loss=5050.9072265625
2023-11-30 14:04:14,360 - root - INFO - epoch=95,number_hard_triplet=167,loss=6641.4697265625
2023-11-30 14:04:16,856 - root - INFO - epoch=96,number_hard_triplet=169,loss=7565.109375
2023-11-30 14:04:19,396 - root - INFO - epoch=97,number_hard_triplet=128,loss=5996.27490234375
2023-11-30 14:04:21,937 - root - INFO - epoch=98,number_hard_triplet=197,loss=7542.52099609375
2023-11-30 14:04:24,474 - root - INFO - epoch=99,number_hard_triplet=185,loss=5982.806640625
2023-11-30 14:04:27,055 - root - INFO - epoch=100,number_hard_triplet=195,loss=7606.9267578125
2023-11-30 14:04:27,059 - root - INFO - scDML training done....
2023-11-30 14:04:27,063 - root - INFO - extract embedding for dataset with trained network
2023-11-30 13:59:05,449 - root - INFO - 创建日志文件...
2023-11-30 13:59:05,456 - root - INFO - 创建 Model 对象完成...
2023-11-30 13:59:05,471 - root - INFO - 正在执行 preprocess() 函数...
2023-11-30 13:59:05,474 - root - INFO - 模式=unsupervised
2023-11-30 13:59:05,478 - root - INFO - 聚类方法=louvain
2023-11-30 13:59:05,481 - root - INFO - 分辨率=3.0
2023-11-30 13:59:05,484 - root - INFO - 批次键=BATCH
2023-11-30 13:59:05,491 - root - INFO - Normalize counts per cell(sum=10000.0)
2023-11-30 13:59:05,801 - root - INFO - Log1p data
2023-11-30 13:59:06,115 - root - INFO - Select HVG(n_top_genes=1000)
2023-11-30 13:59:07,126 - root - INFO - Scale batch(scale_value=10.0)
2023-11-30 13:59:07,758 - root - INFO - Calculate PCA(n_comps=100)
2023-11-30 13:59:23,116 - root - INFO - Apply louvain clustring(resolution=3.0) initization
2023-11-30 13:59:23,121 - root - INFO - Number of Cluster =36
2023-11-30 13:59:23,127 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]
2023-11-30 13:59:23,132 - root - INFO - 预处理数据集完成。
2023-11-30 13:59:23,137 - root - INFO - mode=unsupervised
2023-11-30 13:59:23,262 - root - INFO - K_in=6, K_bw=12
2023-11-30 13:59:23,265 - root - INFO - 开始计算 KNN 和 MNN 以获取簇之间的相似性。
2023-11-30 13:59:23,267 - root - INFO - 使用近似方法计算每个批次内的 KNN 对...
2023-11-30 13:59:23,289 - root - INFO - Calculate KNN pair intra batch...........
2023-11-30 13:59:23,291 - root - INFO - K=6
2023-11-30 13:59:23,293 - root - INFO - metric=cosine
2023-11-30 13:59:23,296 - root - INFO - Processing datasets: (0, 0) = ('M1', 'M1')
2023-11-30 13:59:25,039 - root - INFO - There are (88762) KNN pairs when processing (0, 0)=('M1', 'M1')
2023-11-30 13:59:25,042 - root - INFO - Processing datasets: (1, 1) = ('M2', 'M2')
2023-11-30 13:59:26,679 - root - INFO - There are (83752) KNN pairs when processing (1, 1)=('M2', 'M2')
2023-11-30 13:59:26,682 - root - INFO - Processing datasets: (2, 2) = ('M3', 'M3')
2023-11-30 13:59:27,280 - root - INFO - There are (37118) KNN pairs when processing (2, 2)=('M3', 'M3')
2023-11-30 13:59:27,282 - root - INFO - Processing datasets: (3, 3) = ('M4', 'M4')
2023-11-30 13:59:27,887 - root - INFO - There are (37770) KNN pairs when processing (3, 3)=('M4', 'M4')
2023-11-30 13:59:27,890 - root - INFO - scDML finds (247402) KNN pairs in dataset finally
2023-11-30 13:59:28,270 - root - INFO - 使用近似方法计算批次之间的 MNN 对...
2023-11-30 13:59:28,290 - root - INFO - Calculate MNN pair inter batch...........
2023-11-30 13:59:28,293 - root - INFO - K=12
2023-11-30 13:59:28,297 - root - INFO - metric=cosine
2023-11-30 13:59:28,300 - root - INFO - Processing datasets: (0, 1) = ('M1', 'M2')
2023-11-30 13:59:29,957 - root - INFO - There are (78896) MNN pairs when processing (0, 1)=('M1', 'M2')
2023-11-30 13:59:29,960 - root - INFO - Processing datasets: (0, 2) = ('M1', 'M3')
2023-11-30 13:59:31,136 - root - INFO - There are (56510) MNN pairs when processing (0, 2)=('M1', 'M3')
2023-11-30 13:59:31,138 - root - INFO - Processing datasets: (0, 3) = ('M1', 'M4')
2023-11-30 13:59:32,302 - root - INFO - There are (46166) MNN pairs when processing (0, 3)=('M1', 'M4')
2023-11-30 13:59:32,304 - root - INFO - Processing datasets: (1, 2) = ('M2', 'M3')
2023-11-30 13:59:33,441 - root - INFO - There are (55608) MNN pairs when processing (1, 2)=('M2', 'M3')
2023-11-30 13:59:33,443 - root - INFO - Processing datasets: (1, 3) = ('M2', 'M4')
2023-11-30 13:59:34,604 - root - INFO - There are (54082) MNN pairs when processing (1, 3)=('M2', 'M4')
2023-11-30 13:59:34,606 - root - INFO - Processing datasets: (2, 3) = ('M3', 'M4')
2023-11-30 13:59:35,264 - root - INFO - There are (35764) MNN pairs when processing (2, 3)=('M3', 'M4')
2023-11-30 13:59:35,266 - root - INFO - scDML finds (327026) MNN pairs in dataset finally
2023-11-30 13:59:35,970 - root - INFO - 查找所有最近邻居完成。
2023-11-30 13:59:35,972 - root - INFO - 计算簇之间的相似性矩阵。
2023-11-30 13:59:36,183 - root - INFO - delete inner edge which link same cluster
2023-11-30 13:59:36,186 - root - INFO - 27136 knn pair in batch link different cluster
2023-11-30 13:59:36,411 - root - INFO - delete inner edge which link same cluster
2023-11-30 13:59:36,414 - root - INFO - 149700 mnn pair in batch link different cluster
2023-11-30 13:59:36,417 - root - INFO - ===================================================================================
2023-11-30 13:59:36,420 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=5.516656839622642
2023-11-30 13:59:36,423 - root - INFO - ===================================================================================
2023-11-30 13:59:36,431 - root - INFO - 将相似性矩阵保存到文件中...
2023-11-30 13:59:36,442 - root - INFO - 将 nn 配对矩阵保存到文件中。
2023-11-30 13:59:36,447 - root - INFO - 完成相似性矩阵计算。
2023-11-30 13:59:36,541 - root - INFO - scDML merge cluster with rule2....
2023-11-30 13:59:36,548 - root - INFO - merge_rule2....
2023-11-30 13:59:36,937 - root - INFO - merging cluster set:[{2}, {17}, {18}, {30}, {3, 4, 11, 16, 23, 24, 28}, {32, 1, 34, 35, 14, 15}, {10, 27, 13, 7}, {19, 5, 22}, {0, 33, 21, 25}, {8, 9, 20, 31}, {29, 6}, {26, 12}]
2023-11-30 13:59:36,941 - root - INFO - 为scDML培训构建嵌入网络
2023-11-30 13:59:36,950 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-11-30 13:59:36,954 - root - INFO - 构建嵌入网络完成…
2023-11-30 13:59:36,959 - root - INFO - train scDML(expect_num_cluster=12) with Embedding Net
2023-11-30 13:59:36,962 - root - INFO - expect_num_cluster=12
2023-11-30 13:59:36,965 - root - INFO - 利用CPU训练模型
2023-11-30 13:59:36,970 - root - INFO - use euclidean distance and hard triplet to train model
2023-11-30 13:59:36,973 - root - INFO - not use earlystopping!!!!
2023-11-30 13:59:40,007 - root - INFO - epoch=1,number_hard_triplet=168733,loss=3265.2109375
2023-11-30 13:59:42,927 - root - INFO - epoch=2,number_hard_triplet=68702,loss=6067.0185546875
2023-11-30 13:59:45,979 - root - INFO - epoch=3,number_hard_triplet=49488,loss=6625.716796875
2023-11-30 13:59:49,381 - root - INFO - epoch=4,number_hard_triplet=34646,loss=7551.47265625
2023-11-30 13:59:52,955 - root - INFO - epoch=5,number_hard_triplet=25334,loss=7960.6533203125
2023-11-30 13:59:56,397 - root - INFO - epoch=6,number_hard_triplet=18840,loss=8228.900390625
2023-11-30 14:00:00,147 - root - INFO - epoch=7,number_hard_triplet=15241,loss=8318.857421875
2023-11-30 14:00:03,730 - root - INFO - epoch=8,number_hard_triplet=12203,loss=8946.712890625
2023-11-30 14:00:07,428 - root - INFO - epoch=9,number_hard_triplet=8718,loss=8731.1474609375
2023-11-30 14:00:11,245 - root - INFO - epoch=10,number_hard_triplet=7528,loss=8946.6806640625
2023-11-30 14:00:15,196 - root - INFO - epoch=11,number_hard_triplet=6001,loss=8806.7431640625
2023-11-30 14:00:18,997 - root - INFO - epoch=12,number_hard_triplet=4471,loss=7964.38037109375
2023-11-30 14:00:22,708 - root - INFO - epoch=13,number_hard_triplet=3175,loss=7812.228515625
2023-11-30 14:00:26,350 - root - INFO - epoch=14,number_hard_triplet=3103,loss=7862.49755859375
2023-11-30 14:00:30,087 - root - INFO - epoch=15,number_hard_triplet=2495,loss=7092.224609375
2023-11-30 14:00:33,618 - root - INFO - epoch=16,number_hard_triplet=2103,loss=6991.888671875
2023-11-30 14:00:37,106 - root - INFO - epoch=17,number_hard_triplet=2081,loss=7200.296875
2023-11-30 14:00:40,564 - root - INFO - epoch=18,number_hard_triplet=1674,loss=7539.58203125
2023-11-30 14:00:44,085 - root - INFO - epoch=19,number_hard_triplet=1623,loss=7056.72509765625
2023-11-30 14:00:47,439 - root - INFO - epoch=20,number_hard_triplet=1336,loss=6669.34765625
2023-11-30 14:00:50,737 - root - INFO - epoch=21,number_hard_triplet=1308,loss=6840.115234375
2023-11-30 14:00:54,064 - root - INFO - epoch=22,number_hard_triplet=1173,loss=6712.677734375
2023-11-30 14:00:57,273 - root - INFO - epoch=23,number_hard_triplet=1171,loss=7088.69873046875
2023-11-30 14:01:00,579 - root - INFO - epoch=24,number_hard_triplet=971,loss=6337.60302734375
2023-11-30 14:01:03,769 - root - INFO - epoch=25,number_hard_triplet=1015,loss=6593.388671875
2023-11-30 14:01:06,916 - root - INFO - epoch=26,number_hard_triplet=905,loss=6682.14013671875
2023-11-30 14:01:09,994 - root - INFO - epoch=27,number_hard_triplet=793,loss=6702.71435546875
2023-11-30 14:01:13,084 - root - INFO - epoch=28,number_hard_triplet=749,loss=6689.36767578125
2023-11-30 14:01:16,268 - root - INFO - epoch=29,number_hard_triplet=785,loss=6591.0283203125
2023-11-30 14:01:19,387 - root - INFO - epoch=30,number_hard_triplet=749,loss=6332.79296875
2023-11-30 14:01:22,435 - root - INFO - epoch=31,number_hard_triplet=739,loss=6526.9169921875
2023-11-30 14:01:25,406 - root - INFO - epoch=32,number_hard_triplet=751,loss=7850.2265625
2023-11-30 14:01:28,278 - root - INFO - epoch=33,number_hard_triplet=719,loss=6625.54248046875
2023-11-30 14:01:31,278 - root - INFO - epoch=34,number_hard_triplet=550,loss=6677.9287109375
2023-11-30 14:01:34,286 - root - INFO - epoch=35,number_hard_triplet=571,loss=6515.28759765625
2023-11-30 14:01:37,163 - root - INFO - epoch=36,number_hard_triplet=487,loss=6632.60791015625
2023-11-30 14:01:40,040 - root - INFO - epoch=37,number_hard_triplet=447,loss=5329.44189453125
2023-11-30 14:01:42,847 - root - INFO - epoch=38,number_hard_triplet=407,loss=5996.67578125
2023-11-30 14:01:45,697 - root - INFO - epoch=39,number_hard_triplet=523,loss=7448.4755859375
2023-11-30 14:01:48,645 - root - INFO - epoch=40,number_hard_triplet=469,loss=6292.06591796875
2023-11-30 14:01:51,447 - root - INFO - epoch=41,number_hard_triplet=470,loss=7245.95703125
2023-11-30 14:01:54,219 - root - INFO - epoch=42,number_hard_triplet=388,loss=6542.177734375
2023-11-30 14:01:57,041 - root - INFO - epoch=43,number_hard_triplet=442,loss=6836.08349609375
2023-11-30 14:01:59,782 - root - INFO - epoch=44,number_hard_triplet=468,loss=6340.45654296875
2023-11-30 14:02:02,532 - root - INFO - epoch=45,number_hard_triplet=428,loss=5854.91943359375
2023-11-30 14:02:05,527 - root - INFO - epoch=46,number_hard_triplet=344,loss=4856.65966796875
2023-11-30 14:02:08,237 - root - INFO - epoch=47,number_hard_triplet=403,loss=6396.4140625
2023-11-30 14:02:10,955 - root - INFO - epoch=48,number_hard_triplet=534,loss=8753.40625
2023-11-30 14:02:13,700 - root - INFO - epoch=49,number_hard_triplet=325,loss=6555.021484375
2023-11-30 14:02:16,328 - root - INFO - epoch=50,number_hard_triplet=322,loss=5152.31201171875
2023-11-30 14:02:19,057 - root - INFO - epoch=51,number_hard_triplet=254,loss=5174.22802734375
2023-11-30 14:02:21,927 - root - INFO - epoch=52,number_hard_triplet=245,loss=4922.2470703125
2023-11-30 14:02:24,606 - root - INFO - epoch=53,number_hard_triplet=274,loss=5846.05029296875
2023-11-30 14:02:27,274 - root - INFO - epoch=54,number_hard_triplet=474,loss=7883.24267578125
2023-11-30 14:02:29,980 - root - INFO - epoch=55,number_hard_triplet=302,loss=4632.88330078125
2023-11-30 14:02:32,692 - root - INFO - epoch=56,number_hard_triplet=310,loss=5759.43994140625
2023-11-30 14:02:35,419 - root - INFO - epoch=57,number_hard_triplet=301,loss=6856.2646484375
2023-11-30 14:02:38,201 - root - INFO - epoch=58,number_hard_triplet=413,loss=7370.4287109375
2023-11-30 14:02:40,837 - root - INFO - epoch=59,number_hard_triplet=346,loss=6789.3173828125
2023-11-30 14:02:43,484 - root - INFO - epoch=60,number_hard_triplet=289,loss=6576.34619140625
2023-11-30 14:02:46,063 - root - INFO - epoch=61,number_hard_triplet=283,loss=6615.50537109375
2023-11-30 14:02:48,683 - root - INFO - epoch=62,number_hard_triplet=312,loss=6506.9443359375
2023-11-30 14:02:51,412 - root - INFO - epoch=63,number_hard_triplet=217,loss=4975.95556640625
2023-11-30 14:02:54,175 - root - INFO - epoch=64,number_hard_triplet=247,loss=6454.95556640625
2023-11-30 14:02:56,896 - root - INFO - epoch=65,number_hard_triplet=318,loss=8075.97021484375
2023-11-30 14:02:59,519 - root - INFO - epoch=66,number_hard_triplet=194,loss=6306.3173828125
2023-11-30 14:03:02,140 - root - INFO - epoch=67,number_hard_triplet=266,loss=5495.8515625
2023-11-30 14:03:04,706 - root - INFO - epoch=68,number_hard_triplet=335,loss=5029.50830078125
2023-11-30 14:03:07,314 - root - INFO - epoch=69,number_hard_triplet=404,loss=6674.54833984375
2023-11-30 14:03:10,037 - root - INFO - epoch=70,number_hard_triplet=250,loss=7006.8583984375
2023-11-30 14:03:12,613 - root - INFO - epoch=71,number_hard_triplet=177,loss=5098.55908203125
2023-11-30 14:03:15,181 - root - INFO - epoch=72,number_hard_triplet=192,loss=5906.380859375
2023-11-30 14:03:17,763 - root - INFO - epoch=73,number_hard_triplet=222,loss=6669.85400390625
2023-11-30 14:03:20,281 - root - INFO - epoch=74,number_hard_triplet=154,loss=4796.44091796875
2023-11-30 14:03:22,900 - root - INFO - epoch=75,number_hard_triplet=214,loss=6901.93798828125
2023-11-30 14:03:25,658 - root - INFO - epoch=76,number_hard_triplet=150,loss=4784.81201171875
2023-11-30 14:03:28,236 - root - INFO - epoch=77,number_hard_triplet=197,loss=6312.7724609375
2023-11-30 14:03:30,773 - root - INFO - epoch=78,number_hard_triplet=189,loss=7040.25048828125
2023-11-30 14:03:33,372 - root - INFO - epoch=79,number_hard_triplet=171,loss=6375.41015625
2023-11-30 14:03:35,885 - root - INFO - epoch=80,number_hard_triplet=164,loss=7098.98876953125
2023-11-30 14:03:38,425 - root - INFO - epoch=81,number_hard_triplet=161,loss=6961.478515625
2023-11-30 14:03:41,111 - root - INFO - epoch=82,number_hard_triplet=136,loss=5829.56103515625
2023-11-30 14:03:43,663 - root - INFO - epoch=83,number_hard_triplet=549,loss=7215.38525390625
2023-11-30 14:03:46,193 - root - INFO - epoch=84,number_hard_triplet=192,loss=5844.1943359375
2023-11-30 14:03:48,720 - root - INFO - epoch=85,number_hard_triplet=203,loss=6760.494140625
2023-11-30 14:03:51,230 - root - INFO - epoch=86,number_hard_triplet=159,loss=6695.06494140625
2023-11-30 14:03:53,782 - root - INFO - epoch=87,number_hard_triplet=222,loss=7837.5107421875
2023-11-30 14:03:56,412 - root - INFO - epoch=88,number_hard_triplet=168,loss=5156.3623046875
2023-11-30 14:03:59,055 - root - INFO - epoch=89,number_hard_triplet=154,loss=5724.6796875
2023-11-30 14:04:01,590 - root - INFO - epoch=90,number_hard_triplet=120,loss=6239.14404296875
2023-11-30 14:04:04,124 - root - INFO - epoch=91,number_hard_triplet=117,loss=5141.29248046875
2023-11-30 14:04:06,625 - root - INFO - epoch=92,number_hard_triplet=140,loss=5992.3994140625
2023-11-30 14:04:09,134 - root - INFO - epoch=93,number_hard_triplet=280,loss=6859.0029296875
2023-11-30 14:04:11,750 - root - INFO - epoch=94,number_hard_triplet=116,loss=5050.9072265625
2023-11-30 14:04:14,360 - root - INFO - epoch=95,number_hard_triplet=167,loss=6641.4697265625
2023-11-30 14:04:16,856 - root - INFO - epoch=96,number_hard_triplet=169,loss=7565.109375
2023-11-30 14:04:19,396 - root - INFO - epoch=97,number_hard_triplet=128,loss=5996.27490234375
2023-11-30 14:04:21,937 - root - INFO - epoch=98,number_hard_triplet=197,loss=7542.52099609375
2023-11-30 14:04:24,474 - root - INFO - epoch=99,number_hard_triplet=185,loss=5982.806640625
2023-11-30 14:04:27,055 - root - INFO - epoch=100,number_hard_triplet=195,loss=7606.9267578125
2023-11-30 14:04:27,059 - root - INFO - scDML training done....
2023-11-30 14:04:27,063 - root - INFO - extract embedding for dataset with trained network
